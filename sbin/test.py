#!/usr/bin/env python
#
# Pablo Munoz (c) 2018
#
# Example use of fortran wrapper
#
import numpy as np
from fib import fib, matmul

# Print doc generated by f2py
print(fib.__doc__)

# Use
print(fib(10))
print()

# Use matrix multiplication
N = 100
A = np.eye(N)
B = np.random.rand(N, N)

if not np.testing.assert_array_equal(np.dot(A, B), B):
    print('PYTHON  matrix multiplication test ok')

if not np.testing.assert_array_equal(matmul(A, B, N, N, N), B):
    print('FORTRAN matrix multiplication explicit dimension test ok')

if not np.testing.assert_array_equal(matmul(A, B), B):
    print('FORTRAN matrix multiplication implicit dimension test ok')

